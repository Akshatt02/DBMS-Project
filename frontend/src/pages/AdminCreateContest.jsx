import React, { useState } from 'react';
import { api } from '../apiClient';
import { getToken } from '../auth';

export default function AdminCreateContest() {
  const [name, setName] = useState('');
  const [start, setStart] = useState('');
  const [end, setEnd] = useState('');
  const [desc, setDesc] = useState('');
  const [msg, setMsg] = useState(null);

  const submit = async (e) => {
    e.preventDefault();
    try {
      const token = getToken();
      await api('/contests', { method: 'POST', body: { contest_name: name, start_time: start, end_time: end, description: desc }, token });
      setMsg('Contest created');
      setName(''); setStart(''); setEnd(''); setDesc('');
    } catch (err) {
      setMsg(err.message || 'Failed');
    }
  };

  return (
    <div className="site-wrap">
      <div className="site-container">
        <div className="card max-w-2xl mx-auto">
          <h2 className="text-2xl mb-4">Create Contest</h2>
          {msg && <div className="mb-3 muted">{msg}</div>}
          <form onSubmit={submit} className="space-y-3">
            <input value={name} onChange={e=>setName(e.target.value)} placeholder="Contest name" className="w-full border p-2 rounded" />
            <input value={start} onChange={e=>setStart(e.target.value)} placeholder="Start time (YYYY-MM-DD HH:mm:ss)" className="w-full border p-2 rounded" />
            <input value={end} onChange={e=>setEnd(e.target.value)} placeholder="End time (YYYY-MM-DD HH:mm:ss)" className="w-full border p-2 rounded" />
            <textarea value={desc} onChange={e=>setDesc(e.target.value)} placeholder="Description" className="w-full border p-2 rounded" />
            <button className="w-full btn btn-primary">Create</button>
          </form>
        </div>
      </div>
    </div>
  );
}
